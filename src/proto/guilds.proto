syntax = "proto3";

package guilds;


service GuildsService {
    rpc FindAll(FindAllRequest) returns (FindAllResponse);
    rpc CheckPermission(CheckPermissionRequest) returns (CheckPermissionResponse);
}

message FindAllRequest {
    string userId = 1;
}

message FindAllResponse {
    int32 status = 1;
    repeated Guild data = 2;
}

message CheckPermissionRequest {
  string userId = 1;
  string guildId = 2;
  string channelId = 3;
  string permission = 4;
}

message CheckPermissionResponse {
  bool isAllowed = 1;
}


message Guild {
  string id = 1;
  string name = 2;
  string ownerId = 3;
  string iconURL = 4;
  repeated Channel channels = 5;
  string createdAt = 6;
  string updatedAt = 7;
  repeated GuildMember members = 8;
  repeated Role roles = 9;
}

message UserChannelState {
  string lastReadId = 1;
  int32 unreadCount = 2;
  int32 mentionCount = 3;
}

message Channel {
  string id = 1;
  string name = 2;
  ChannelType type = 3;
  string createdAt = 5;
  string updatedAt = 6;
  Channel parent = 7;
  Guild guild = 8;
  repeated UserProfile recipients = 9;
  string lastReadId = 10;
  string guildId = 11;
  UserChannelState userChannelState = 12;
  repeated PermissionOverwrite permissionOverwrites = 13;
  bool isSynced = 14;
}

enum ChannelType {
  TEXT = 0;
  VOICE = 1;
  CATEGORY = 2;
  DM = 3;
}

enum UserStatus {
  OFFLINE = 0;
  ONLINE = 1;
  INVISIBLE = 2;
  IDLE = 3;
  DO_NOT_DISTURB = 4;
}

message UserProfile {
  string id = 1;
  string displayName = 2;
  string username = 3;
  string pronouns = 4;
  string bio = 5;
  UserStatus status = 6;
  string avatarURL = 7;
  string defaultAvatarURL = 8;
  string createdAt = 9;
  string updatedAt = 10;
}

message Role {
  string id = 1;
  string name = 2;
  string permissions = 3;
  int32 position = 4;
  bool isHoisted = 5;
  string guildId = 6;
  int32 color = 7;
}

message GuildMember {
  string userId = 1;
  repeated string roles = 2;
  UserProfile profile = 3;
}

message PermissionOverwrite {
  string allow = 2;
  string deny = 3;
  string targetId = 4;
  string targetType = 5;
  string channelId = 6;
}